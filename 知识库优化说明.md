# 知识库功能优化说明

## 核心功能升级

### 1. 多选操作
- **复选框支持**：每个文件和文件夹前都有复选框，支持单选和多选
- **全选文件夹**：右键菜单中可一键选中整个文件夹及其内容
- **批量操作工具栏**：选中文件后自动显示工具栏，支持批量删除等操作
- **选中状态指示**：选中的项目以蓝色背景高亮显示

### 2. 文件上传
- **拖拽上传**：支持直接拖拽文件到知识库区域
- **点击上传**：通过上传按钮选择文件
- **文件夹上传**：支持上传整个文件夹（包含目录结构）
- **上传对话框**：提供清晰的上传界面和操作提示

### 3. 文件树结构
- **分层展示**：支持无限层级的文件夹嵌套
- **展开/收起**：点击文件夹可展开或收起子内容
- **视觉缩进**：根据层级自动缩进，清晰展示结构关系

### 4. 右键菜单
- **预览**：快速查看文件内容
- **重命名**：直接在树中编辑文件名
- **下载**：下载选中的文件
- **删除**：删除文件或文件夹
- **全选文件夹**：批量选择文件夹内所有内容

### 5. 搜索功能
- **实时搜索**：输入即搜，即时过滤结果
- **智能匹配**：匹配文件名和路径
- **高亮显示**：搜索结果自动展开文件夹

### 6. 文件信息展示
- **文件图标**：根据文件类型自动显示对应图标（PDF、Word、Excel等）
- **文件大小**：悬停显示文件大小
- **子项计数**：文件夹显示包含的子项数量
- **修改时间**：显示最后修改时间（今天、昨天、N天前）

### 7. 可收起侧边栏
- **一键收起/展开**：点击边缘按钮切换显示状态
- **节省空间**：收起后为主工作区提供更多空间
- **平滑动画**：收起展开带有流畅的过渡效果

### 8. 视觉优化
- **文件类型色彩**：不同类型文件使用不同的emoji图标
- **悬停效果**：鼠标悬停时显示更多信息
- **选中反馈**：清晰的选中状态视觉反馈
- **空状态提示**：无文件时显示友好的空状态提示

## 交互体验优化

### 操作流程
1. **添加文件**：点击 + 按钮或拖拽文件到面板
2. **浏览文件**：展开/收起文件夹，滚动查看
3. **搜索定位**：使用搜索框快速找到目标文件
4. **多选操作**：勾选多个文件进行批量操作
5. **右键操作**：右键打开上下文菜单执行各种操作
6. **重命名**：双击或右键选择重命名，直接在列表中编辑

### 快捷操作
- **拖拽上传**：直接拖拽文件到面板
- **Enter确认**：重命名时按Enter确认
- **Esc取消**：重命名时按Esc取消
- **点击展开**：单击文件夹名称展开/收起

### 反馈机制
- **Toast通知**：所有操作都有成功/失败提示
- **加载状态**：文件上传等异步操作显示加载动画
- **选中计数**：实时显示已选中的文件数量
- **操作确认**：删除等危险操作需要确认

## 技术实现

### 组件结构
```
KnowledgeBase
├── Header (搜索、标题)
├── Selection Toolbar (批量操作栏)
├── File Tree (文件树)
│   ├── FileNode (递归渲染)
│   ├── ContextMenu (右键菜单)
│   └── Checkbox (多选框)
├── Footer Actions (底部操作按钮)
└── Dialogs (上传、创建文件夹等对话框)
```

### 核心特性
- **递归渲染**：支持无限层级的文件树
- **状态管理**：集中管理选中、展开等状态
- **拖拽支持**：HTML5 Drag & Drop API
- **文件过滤**：递归搜索和过滤算法
- **类型安全**：完整的TypeScript类型定义

### 辅助工具函数
- `formatFileSize`: 格式化文件大小
- `formatDate`: 格式化日期显示
- `getFileIcon`: 根据MIME类型返回图标
- `findNodeById`: 在树中查找节点
- `getAllFiles`: 获取所有文件节点

## 未来扩展方向

1. **文件预览**：支持图片、PDF等文件的在线预览
2. **版本管理**：记录文件修改历史
3. **权限控制**：设置文件的访问权限
4. **标签系统**：为文件添加标签便于分类
5. **云端同步**：支持与云存储服务同步
6. **协作功能**：多人同时编辑和注释
7. **AI辅助**：智能分类、内容提取等
